<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<title></title>
</head>
<body>

<p>
	An optional number n1: <input type="text" id="txtn1"/>
</p>

<p>n1 saved value: <span id="n1Saved"/></p>


<p>
	An required number n2: <input type="text" id="txtn2"/>
</p>

<p>n2 saved value: <span id="n2Saved"/></p>

<p>
	An optional number n3: <input type="text" id="txtn3"/>
</p>

<p>n3 saved value: <span id="n3Saved"/></p>


<p>
	global error: <span id="globalError"></span>
</p>

<input id="btnSubmit" type="button" value="Submit"/>

<span id="xyz"></span>
</body>
<script src="http://code.jquery.com/jquery.js"></script>
<script src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.js"></script>
<script src="../ref/jquery.tmplPlus.js"></script>
<script type="text/javascript" src="../dist/viaProxy.all.debug.js"></script>
<style type="text/css">
	.error {
		border: solid 1px red;
		background-color: #ffcccc;
	}
</style>

<script>
	via().create( "n1", null );
	via().create( "n2", null );
	via().create( "n3", null );

	via.validate( "n3", "number" )
		.validate( "n3", {
			isValid:function ( value ) {
				return !$.isNaN( value ) && (value >= 10);
			} ,
			error: "it must be over 9"
		} );
</script>


<script>
	$( function() {
		$( "#txtn1" )
			.addModelHandler( "n1", "init", "$val" )
			.addViewHandler( "keyup", "n1", "$val" )
			.addModelHandler( "n1", "beforeUpdate", "*number" )
			.addModelHandler( "n1*errors", "after*", "*inlineError" );

		$( "#n1Saved" ).addModelHandler( "n1", "afterUpdate", "$text" );

		$( "#txtn2" )
			.addModelHandler( "n2", "init", "$val" )
			.addViewHandler( "keyup", "n2", "$val" )
			.addModelHandler( "n2", "beforeUpdate", "*required" )
			.addModelHandler( "n2", "beforeUpdate", "*number" )
			.addModelHandler( "n2*errors", "after*", "*inlineError" );

		$( "#n2Saved" ).addModelHandler( "n2", "afterUpdate", "$text" );

		$( "#txtn3" )
			.addModelHandler( "n3", "init", "$val" )
			.addViewHandler( "keyup", "n3", "$val" )
			.addModelHandler( "n3*errors", "after*", "*inlineError" );

		$( "#n3Saved" ).addModelHandler( "n3", "afterUpdate", "$text" );

		$( "#globalError" ).addModelHandler( "*invalidModelPaths", "after*", "$text" );

		$( "#btnSubmit" ).click(
			function () {
				if ( via().isValid() ) {
					alert( "sending data..." );
				} else {
					alert( "please correct highlighted error" );
				}
			} ).addModelHandler( "*invalidModelPaths", "init|after*", "*enableIfFalsy" );

	} );
</script>
</html>